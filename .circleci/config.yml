version: 2.1
workflows:
  version: 2
  build_deploy_test:
    jobs:
      - pfe/gatsby_build_and_deploy:
         post-steps:
            - run: curl "https://api.github.com/repos/${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}/statuses/$CIRCLE_SHA1?access_token=$GITHUB_TOKEN" -X POST  -d '{"state": "success", "context": "pantheon/deployment", "description": "Deployment complete", "target_url": "https://${TERMINUS_ENV}-${TERMINUS_SITE}.pantheonsite.io/"}'
      - pfe/make_multidev:
          filters:
            branches:
              ignore: "master"
orbs:
  # fauxalgore is a joke username where I publish experimental
  # code. https://github.com/fauxalgore/orbs This repo is a playground
  # for Orbs that might become stable elsewhere.
  pfe: fauxalgore/playground@dev:pantheon_frontend
